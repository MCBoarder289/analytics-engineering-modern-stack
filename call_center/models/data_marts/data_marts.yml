version: 2

models:
  - name: mart_calls
    description: "Data mart containing individual telephony records, measurements, and relevant dimensions"
    columns:
      - name: call_id
        data_type: bigint
        data_tests:
          - unique
          - not_null
        description: "Unique identifier for the call in the telephony system"

      - name: agent_id
        data_type: bigint
        description: "Unique identifier for the agent who handled the call"

      - name: agent_name
        data_type: varchar
        description: "Display name for the agent who took the call"

      - name: customer_id
        data_type: bigint
        description: "Unique identifier for the customer served on the call"

      - name: customer_program
        data_type: varchar
        description: "Specific program subscription for the customer"

      - name: queue_hold_time
        data_type: bigint
        description: "Amount of time the caller was on hold before the call was picked up by the agent in seconds"

      - name: start_ts
        data_type: timestamp with time zone
        description: "Timestamp of when the call started"

      - name: end_ts
        data_type: timestamp with time zone
        description: "Timestamp of when the call ended"

      - name: duration_s
        data_type: bigint
        description: "Duration of the entire call in seconds"

      - name: hold_time_during_call_s
        data_type: bigint
        description: "Amount of time the caller was on hold during the call in seconds"

      - name: transfer_flag
        data_type: boolean
        description: "Indicator that the call was escalated to a manager"

      - name: warehouse_updated_ts
        data_type: timestamp with time zone
        description: "Timestamp of when this record was loaded or changed in the data warehouse"

  - name: mart_crm
    description: "Data mart containing all of the crm records for each call and the relevant dimensions"
    columns:
      - name: crm_id
        data_tests:
          - unique
          - not_null
        data_type: bigint
        description: "Unique identifier for the crm record in the crm system"

      - name: agent_id
        data_type: bigint
        description: "Unique identifier for the agent who handled the call"

      - name: agent_name
        data_type: varchar
        description: "Display name for the agent who took the call"

      - name: call_id
        data_type: bigint
        description: "Unique identifier for the call in the telephony system"

      - name: customer_id
        data_type: bigint
        description: "Unique identifier for the customer served"

      - name: customer_program
        data_type: varchar
        description: "Specific program subscription for the customer"

      - name: reason_code
        data_type: varchar
        description: "High level reason selected by agent representing why the customer called"

      - name: sub_reason_code
        data_type: varchar
        description: "More detailed reason selected by agent on the specific reason for the call"

      - name: previous_issue_flag
        data_type: boolean
        description: "Agent input as to whether this call was about a previous issue"

      - name: created_ts
        data_type: timestamp with time zone
        description: ""

      - name: warehouse_updated_ts
        data_type: timestamp with time zone
        description: "Timestamp of when this record was loaded or changed in the data warehouse"

  - name: mart_crm_callbacks
    description: "Data mart containing all of the callback records for each crm record and the relevant dimensions for computing first call resolution"
    columns:
      - name: original_crm_id
        data_type: bigint
        description: "Unique identifier for the original crm record in the crm system for the callback"

      - name: callback_crm_id
        data_type: bigint
        description: "Unique identifier for the callback crm record in the crm system relating to the original crm record"

      - name: original_agent_id
        data_type: varchar
        description: "Agent ID that handled the original call"

      - name: callback_agent_id
        data_type: varchar
        description: "Agent ID that handled the callback"

      - name: customer_id
        data_type: bigint
        description: "Unique identifier for the customer served"

      - name: original_created_ts
        data_type: timestamp with time zone
        description: "Timestamp of the original call"

      - name: callback_created_ts
        data_type: timestamp with time zone
        description: "Timestamp of the callback"

      - name: days_between
        data_type: int
        description: "Number of days between the original call and the callback"
      
      - name: same_reason_flag
        data_type: boolean
        description: "Flag whether the callback had the same reason code as the original call"

      - name: same_sub_reason_flag
        data_type: boolean
        description: "Flag whether the callabck had the same sub reason code as the original call"

      - name: callback_previous_issue_flag
        data_type: boolean
        description: "Agent input as to whether this callback was about a previous issue"

      - name: warehouse_updated_ts
        data_type: timestamp with time zone
        description: "Timestamp of when this record was loaded or changed in the data warehouse"

  - name: mart_surveys
    description: "Data mart containing customer survey responses and relevant dimensions"
    columns:
      - name: survey_id
        data_type: bigint
        data_tests:
          - unique
          - not_null
        description: "Unique identifier for the survey in the survey system"

      - name: call_id
        data_type: bigint
        description: "Unique identifier for the call in the telephony system"

      - name: agent_id
        data_type: bigint
        description: "Unique identifier for the agent who handled the call"

      - name: agent_name
        data_type: varchar
        description: "Display name for the agent who took the call"

      - name: customer_id
        data_type: bigint
        description: "Unique identifier for the customer served"

      - name: customer_program
        data_type: varchar
        description: "Specific program subscription for the customer"

      - name: sent_ts
        data_type: timestamp with time zone
        description: "Timestamp when the survey was sent"

      - name: response_ts
        data_type: timestamp with time zone
        description: "Timestamp when the survey was received"

      - name: days_to_respond
        data_type: bigint
        description: "Calculated number of days the customer took to respond"

      - name: csat
        data_type: bigint
        description: "Response to the customer satisfaction question (1 - 5 stars)"
        data_tests:
          - accepted_values:
              arguments:
                values: [1, 2, 3, 4, 5]
                quote: false


      - name: nps
        data_type: bigint
        description: "Response to the NPS question (On a scale of 1 - 10, how likely are you to recommend this service to a friend?)"
        data_tests:
          - accepted_values:
              arguments:
                values: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
                quote: false


      - name: nps_calc
        data_type: integer
        description: "Calculated NPS numerator of whether the response was a promoter/neutral/detractor"
        data_tests:
          - accepted_values:
              arguments:
                values: [-1, 0, 1]
                quote: false

      - name: warehouse_updated_ts
        data_type: timestamp with time zone
        description: "Timestamp of when this record was loaded or changed in the data warehouse"

